(function(){window.badMonkey=function(){function concatObject(a){str="";for(prop in a){str+=prop+" value :"+a[prop]+"<br/>"}str+="----------------------<br/>";return str}function updateFruitsGUI(a){$(".fruitcount span").text(a)}function stagePanning(a,b){var c=a/canvas.width;var d=(groundWidth-canvas.width)*c;var e=b-a;if(e>1&&dollyx>-500){dollyx-=d/50}if(e<1&&dollyx<-10){dollyx+=d/50}}function addSparkles(a,b,c,d){var e=Math.floor(Math.random()*10)%3;for(var f=0;f<a;f++){var g={images:[imgfrm[e]],frames:{width:21,height:23,regX:10,regY:11}};var h=new BitmapAnimation(new SpriteSheet(g));var i=h.clone();i.x=b;i.y=c;i.alpha=Math.random()*.5+.5;i.scaleX=i.scaleY=Math.random()+.3;var j=Math.PI*2*Math.random();var k=(Math.random()-.5)*30*d;i.vX=Math.cos(j)*k;i.vY=Math.sin(j)*k;i.vS=(Math.random()-.5)*.2;i.vA=-Math.random()*.05-.01;i.gotoAndPlay(Math.random()*i.spriteSheet.getNumFrames()|0);base.world.easelStage.addChild(i);sparkleMap.push(i)}}function objectSize(a){var b=0;for(key in a){if(a.hasOwnProperty(key)){b++}}return b}function showthis(){clearStage(base.world.easelStage);startGame()}function clearStage(a){a.removeAllChildren();var b=base.world.objects;for(k in objMap){base.world.removeEntity(objMap[k]);delete objMap[k]}}function followPoint(a,b){dollyx-=(dollyx-a)/b}function getTime(){var a=new Date;var b=a.getHours();var c=a.getMinutes();var d="AM";if(b>12){d="PM"}else{d="AM"}b=b>12?b-12:b;return b+":"+c+" "+d}function reverseCam(a,b){if(gameover){gameResults();gameover=false}else{setTimeout(function(){rollingTarget=a;rollingSpeed=b;rolling=true},1e3)}}function addMask(a){if(a){$(".pause, .score, .highscore, .fruitcount").hide();$(".container").append('<div class="mask"></div><div class="pausemenu"><div class="soundp"></div><div class="pas clicked"></div><div class="menup"></div></div>');base.world.Ticks.setPaused(true);$(".pas").click(function(){$(".mask, .pausemenu").remove();$(".pause, .score, .highscore, .fruitcount").show();base.world.Ticks.setPaused(false)});$(".soundp").toggle(function(){$(this).addClass("clicked")},function(){$(this).removeClass("clicked")});$(".menup").click(function(){$(".mask, .pausemenu").remove();base.world.Ticks.setPaused(false);var a=canvas.getContext("2d");a.clearRect(0,0,canvas.width,canvas.height);loadGUI()})}else{};}function gameResults(){gameStart=false;var a=$(".fruitcount span").html();$(".dbug_delete").append("<span>["+getTime()+"]</span> "+$(".score span").html()+"<br/>");showInGameUI(false);var b=new Shape;var c=b.graphics;c.beginFill("rgba(255, 255, 255, 0.5)");c.drawRect(0,0,1600,canvas.height);b.x=0;base.world.easelStage.addChild(b);if(badassKill>=totalBadass){gamewin=true;badassKill=0}else{gamewin=false;badassKill=0}console.log(base.world.easelStage.x);var d=base.world.addImage(imglists.popup,{x:-1*(dollyx-180),y:(canvas.height-363)/2});if(gamewin){var e=Math.ceil(a/totalFruit*2);var f=new spriteLoader(spriteLists.statustext,base.world.easelStage);f.animation.x=d.x+245;f.animation.y=d.y+70;f.animation.gotoAndStop("win");for(var g=0;g<e;g++){var h=base.world.addImage(imglists.stargfx,{x:d.x+172+50*g,y:d.y+154})}var i=new spriteLoader(spriteLists.homebtn,base.world.easelStage);i.animation.x=d.x+135;i.animation.y=d.y+300;i.animation.gotoAndStop("normal");var j=new spriteLoader(spriteLists.replaybtn,base.world.easelStage);j.animation.x=d.x+245;j.animation.y=d.y+300;j.animation.gotoAndStop("normal");var k=new spriteLoader(spriteLists.nextbtn,base.world.easelStage);k.animation.x=d.x+355;k.animation.y=d.y+300;k.animation.gotoAndStop("normal");k.animation.onPress=function(a){k.animation.gotoAndStop("hit");a.onMouseUp=function(a){currentLevel++;loadGameLevels(currentLevel)}}}else{var f=new spriteLoader(spriteLists.statustext,base.world.easelStage);f.animation.x=d.x+245;f.animation.y=d.y+70;f.animation.gotoAndStop("fail");var i=new spriteLoader(spriteLists.homebtn,base.world.easelStage);i.animation.x=d.x+170;i.animation.y=d.y+300;i.animation.gotoAndStop("normal");var j=new spriteLoader(spriteLists.replaybtn,base.world.easelStage);j.animation.x=d.x+320;j.animation.y=d.y+300;j.animation.gotoAndStop("normal")}j.animation.onPress=function(a){j.animation.gotoAndStop("hit");a.onMouseUp=function(a){loadGameLevels(currentLevel)}};i.animation.onPress=function(a){i.animation.gotoAndStop("hit");a.onMouseUp=function(a){loadGUI()}}}function showInGameUI(a,b,c){b=b||false;c=c||false;if(a){if(!$(".pause").length){$(".container").append('<div class="pause"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="score gameui">SCORE <span>0</span></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="highscore gameui">HIGH<span>0</span></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="fruitcount gameui"><img src="'+b+'"> X <span>'+c+"</span></div>")}$(".pause, .score, .highscore, .fruitcount").show();if($(".pause").length){$(".pause").click(function(){addMask(true)})}}else{$(".pause, .score, .highscore, .fruitcount").remove()}}function monkeyType(a){this.userData=a.userData;this.isHit=false;this.strength=a.strength;this.dead=false}function restart(){gameWorld={};cFruit=[];totalBadass=0;totalFruit=0;badassKill=0;base.world.easelStage.removeAllChildren();base.world.easelStage.clear()}function loadGameLevels(level){restart();base.world=new EaselBoxWorld(this,framerate,canvas,debugCanvas,gravityX,gravityY,ppm);dollyx=-500;var assets=eval("GameLevel.level_"+level);gamebg=base.world.addImage(assets.background);var ground=base.world.addImage(assets.ground,{x:0,y:470});var GameObject=assets.gameObject;for(var i=0;i<GameObject.length;i++){base.world.addImage(GameObject[i].img,{x:GameObject[i].x,y:GameObject[i].y})}mike=new littleBoys(assets.character,base.world.easelStage,170,450);mike.animation.gotoAndStop("normal");var fruitList=assets.fruitObject;var currentFruit=assets.totalFruit-1;cFruit.push(fruitList[currentFruit].userData);gameWorld[cFruit[cFruit.length-1]]=new monkeyType(fruitList[currentFruit]);base.world.addEntity(fruitList[currentFruit]);var ourFruit=new fruits;ourFruit.fruitsTotal=assets.totalFruit;ourFruit.init(cFruit[cFruit.length-1]);totalFruit=ourFruit.fruitsTotal;totalBadass=assets.badMonkey;showInGameUI(true,imglists.appleui,ourFruit.fruitsTotal);fruitProjectile=new animSprite(projTile,base.world.easelStage,125,450);fruitPreProj=new spriteLoader(spriteLists.preprojTile,base.world.easelStage);fruitPreProj.animation.x=125;fruitPreProj.animation.y=450;fruitPreProj.animation.gotoAndStop("a");var RigidBody=assets.rigidBody;for(var i=0;i<RigidBody.length;i++){gameWorld[RigidBody[i].userData]=new monkeyType(RigidBody[i])}myBadMonkey.addToWorld(RigidBody);gameStart=true;var activeRoll=setTimeout(function(){rolling=true;rollingTarget=0;rollingSpeed=7;clearTimeout(activeRoll)},1e3);gamebg.onPress=function(a){if(called){rollingTarget=-500;rollingSpeed=7;rolling=true;called=false}else{rollingTarget=0;rollingSpeed=7;rolling=true;called=true}};ground.onPress=function(a){var b=a.stageX;a.onMouseMove=function(a){stagePanning(a.stageX,b)}};base.world.addContactListener({BeginContact:function(a,b){for(var c in cFruit){if(a==cFruit[c]||b==cFruit[c]){if($.inArray(cFruit[c],damFruit)==-1){damFruit.push(cFruit[c])}collisionStart=true}}},PostSolve:function(a,b,c){if(c<.1)return;var d=gameWorld[a];var e=gameWorld[b];if(d!=undefined&&e!=undefined){d.hit(c,e);e.hit(c,d)}}});switch(level){case 3:base.world.addRevoluteJoint("minibox_0","rope",{motorSpeed:-2,maxMotorTorque:10});base.world.addRevoluteJoint("tire","rope");break;default:break}}function LevelSelection(){var a=200;var b=400;var c=0;for(var d=0;d<2;d++){for(var e=0;e<5;e++){c++;var f=new spriteLoader(spriteLists.levelbtn,base.world.easelStage);f.animation.x=a+100*e;f.animation.y=b+100*d;if(e==0&&d==0)f.animation.gotoAndStop("nostar");else if(e==1&&d==0)f.animation.gotoAndStop("onestar");else if(e==2&&d==0)f.animation.gotoAndStop("twostar");else f.animation.gotoAndStop("lock");f.animation.tagname=c;f.animation.onPress=function(a){currentLevel=this.tagname;switch(this.tagname){case 1:case 2:case 3:loadGameLevels(currentLevel);break;default:break}}}}}function loadGUI(){dollyx=0;restart();base.world.easelStage.x=0;base.world.addImage(imglists.startbg);var a=new spriteLoader(spriteLists.startbtn,base.world.easelStage);a.animation.x=400;a.animation.y=400;a.animation.gotoAndStop("normal");a.animation.onPress=function(b){a.animation.gotoAndStop("hit");b.onMouseUp=function(b){$(".loader").remove();a.animation.gotoAndStop("normal");LevelSelection();base.world.easelStage.removeChild(a.animation)}};base.world.easelStage.update()}function loadPreloader(){var a=new PxLoader;for(key in imglists){var b=new PxLoaderImage(imglists[key]);b.imageNumber=key+1;a.add(b)}$(".loader").show();float(true);a.addProgressListener(function(a){$(".loader").text(Math.floor(a.completedCount/a.totalCount*100)+" %")});a.addCompletionListener(function(){$(".loader").remove();loadGUI()});a.start()}function float(a){$(".loader").stop().animate({path:new $.path.arc({center:[295,200],radius:180,start:65,end:-295,dir:-1})},5e3,"linear")}function badMonkey(a,b){base=this;loadPreloader();base.world=new EaselBoxWorld(this,framerate,a,b,gravityX,gravityY,ppm)}var framerate=20,gravityX=0,gravityY=10,ppm=30;var camLook=false;var called=false;var defaultworld;var circle;var circleInitPos;var man;var deleted=false;var g,s,x,y;var spark;var mon,mon1;var getit=true;var curPos=0;var cams=0;var balljumped_high=null;var balljumped_low=null;var eagle;var ourFruit;var base;var gamebg;var mike;var fruitProjectile;var fruitPreProj;var objMap={};var gameWorld={};var totalBadass=0;var totalFruit=0;var badassKill=0;var dollyx=0;var groundWidth=1400;var gameStart=false;var rolling=false;var rollingTarget;var rollingSpeed;var currentLevel=1;var cFruit=[];var damFruit=[];var muteEn=false;var gameover=false;var gamewin=false;var collisionStart=false;var camFollow=false;var camTarget={};var backtopav=false;var cvs;var imglists={startbg:"img/title.jpg",startbtn:"img/play.png",replaybtn:"img/replay.png",homebtn:"img/home.png",pausebtn:"img/pause.png",stargfx:"img/star.png",nextbtn:"img/next.png",levelbtn:"img/levelbtn.png",soundbtn:"img/mute.png",menubtn:"img/lvl_btn.png",statustxt:"img/status.png",pausetxt:"img/paused_txt.png",gamebg:"img/bg.jpg",ground:"img/ground.png",minibox:"img/minibox.png",wood_low:"img/wood_low.png",wood_high:"img/wood_high.png",wood_wide:"img/wood_wide.png",tire:"img/tire.png",rope:"img/rope.png",topground:"img/topground.png",monkeysmall:"img/cutemonkey.png",mike:"img/man.png",apple:"img/ball.png",projectile:"img/projectile.png",preprojectile:"img/pre-projectile.png",lgtree:"img/b_tree.png",monkey1:"img/monkeys.png",explode_leaf:"img/leaf.png",explode_red:"img/sparkle_red_21x23.png",explode_yellow:"img/sparkle_y_21x23.png",appleui:"img/uiapple.png",popup:"img/popup.png"};var ourChar={mike:{images:[imglists.mike],frames:{width:100,height:100,regX:50,regY:50},animations:{"throw":[0,4,false,2],idle:[4,4],normal:[0,0]}}};var GameLevel={level_1:{background:imglists.gamebg,ground:imglists.ground,character:ourChar.mike,totalFruit:4,gameObject:[{img:imglists.lgtree,x:750,y:205}],fruitObject:[{userData:"apple1",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8},{userData:"apple2",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8},{userData:"apple3",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8},{userData:"apple4",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8}],rigidBody:[{userData:"ground1",type:"static",imgSrc:"img/asd.png",widthPixels:3200,heightPixels:2,xPixels:0,yPixels:600-100},{userData:"ground2",type:"static",widthPixels:2,heightPixels:1200,xPixels:1600+800,yPixels:0},{userData:"ground3",type:"static",widthPixels:2,heightPixels:1200,xPixels:0,yPixels:0},{userData:"grab_0",type:"static",imgSrc:imglists.monkey1,widthPixels:46,heightPixels:50,xPixels:920,yPixels:400,strength:25},{userData:"grab_1",type:"static",imgSrc:imglists.monkey1,widthPixels:46,heightPixels:50,xPixels:820,yPixels:370,strength:20}],badMonkey:2},level_2:{background:imglists.gamebg,ground:imglists.ground,character:ourChar.mike,totalFruit:4,gameObject:[{img:imglists.lgtree,x:750,y:205}],fruitObject:[{userData:"apple1",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8},{userData:"apple2",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8},{userData:"apple3",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8},{userData:"apple4",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8}],rigidBody:[{userData:"ground1",type:"static",imgSrc:"img/asd.png",widthPixels:3200,heightPixels:2,xPixels:0,yPixels:600-100},{userData:"ground2",type:"static",widthPixels:2,heightPixels:1200,xPixels:1600+800,yPixels:0},{userData:"ground3",type:"static",widthPixels:2,heightPixels:1200,xPixels:0,yPixels:0},{userData:"topground",type:"static",imgSrc:imglists.topground,widthPixels:290,heightPixels:24,xPixels:920,yPixels:400},{userData:"minibox_0",type:"dynamic",imgSrc:imglists.minibox,widthPixels:35,heightPixels:30,xPixels:830,yPixels:350-0*30,density:.5,restitution:.1,friction:10,strength:50},{userData:"minibox_1",type:"dynamic",imgSrc:imglists.minibox,widthPixels:35,heightPixels:30,xPixels:835,yPixels:350-1*30,density:.5,restitution:.1,friction:10,angleDegrees:90,strength:50},{userData:"minibox_2",type:"dynamic",imgSrc:imglists.minibox,widthPixels:35,heightPixels:30,xPixels:1020,yPixels:350-0*30,density:.5,restitution:.1,friction:10,strength:50},{userData:"minibox_3",type:"dynamic",imgSrc:imglists.minibox,widthPixels:35,heightPixels:30,xPixels:1025,yPixels:350-1*30,density:.5,restitution:.1,friction:10,angleDegrees:90,strength:50},{userData:"woodHigh_0",type:"dynamic",imgSrc:imglists.wood_high,widthPixels:15,heightPixels:100,xPixels:850+1*2*15,yPixels:350,density:.5,restitution:.1,friction:10,strength:50},{userData:"woodHigh_1",type:"dynamic",imgSrc:imglists.wood_high,widthPixels:15,heightPixels:100,xPixels:850+4*2*15,yPixels:350,density:.5,restitution:.1,friction:10,strength:50},{userData:"woodWide_0",type:"dynamic",imgSrc:imglists.wood_wide,widthPixels:90,heightPixels:30,xPixels:850+1*2*15,yPixels:350-1*100,density:.5,restitution:.1,friction:10,strength:50},{userData:"woodWide_1",type:"dynamic",imgSrc:imglists.wood_wide,widthPixels:90,heightPixels:30,xPixels:850+4*2*15,yPixels:350-1*100,density:.5,restitution:.1,friction:10,strength:50},{userData:"grab_0",type:"dynamic",imgSrc:imglists.monkeysmall,widthPixels:30,heightPixels:30,xPixels:810+4*2*15,yPixels:350,strength:25}],badMonkey:1},level_3:{background:imglists.gamebg,ground:imglists.ground,character:ourChar.mike,totalFruit:4,gameObject:[{img:imglists.lgtree,x:750,y:205}],fruitObject:[{userData:"apple1",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8},{userData:"apple2",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8},{userData:"apple3",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8},{userData:"apple4",type:"static",imgSrc:imglists.apple,radiusPixels:10,xPixels:125,yPixels:600-150,angleRadians:45,angularVelRadians:2,density:4,restitution:.5,linearDamping:.8}],rigidBody:[{userData:"ground1",type:"static",imgSrc:"img/asd.png",widthPixels:3200,heightPixels:2,xPixels:0,yPixels:600-100},{userData:"ground2",type:"static",widthPixels:2,heightPixels:1200,xPixels:1600+800,yPixels:0},{userData:"ground3",type:"static",widthPixels:2,heightPixels:1200,xPixels:0,yPixels:0},{userData:"ground4",type:"static",widthPixels:2,heightPixels:1200,xPixels:1600,yPixels:0},{userData:"minibox_0",type:"static",imgSrc:imglists.minibox,widthPixels:35,heightPixels:30,xPixels:830,yPixels:350-0*30,density:.5,restitution:.1,friction:10},{userData:"rope",type:"dynamic",imgSrc:imglists.rope,widthPixels:4,heightPixels:100,xPixels:830,yPixels:350+100/2},{userData:"tire",type:"dynamic",imgSrc:imglists.tire,radiusPixels:22,xPixels:830,yPixels:350+40/2+100,density:.8,friction:10,restitution:1},{userData:"grab_0",type:"dynamic",imgSrc:imglists.monkeysmall,widthPixels:30,heightPixels:30,xPixels:810+4*2*15-30,yPixels:350+70-40,strength:25}],badMonkey:1}};var animSprite=function(a,b,c,d){this.isInIdleMode=true;this.animation=new BitmapAnimation(new SpriteSheet(a));this.animation.x=c;this.animation.y=d;b.addChild(this.animation)};var littleBoys=function(a,b,c,d){animSprite.call(this,a,b,c,d);this.isInIdleMode=true};monkeyType.prototype.hit=function(a,b){this.isHit=true;if(this.strength){this.strength-=a;if(this.strength<=0){this.dead=true;if(this.userData=="grab_0"||this.userData=="grab_1"){var c=base.world.bodiesMap[this.userData];$(".score span").html(parseInt($(".score span").html())+1450);addSparkles(Math.random()*200+100|0,c.easelObj.x,c.easelObj.y,2);badassKill++}else{var c=base.world.bodiesMap[this.userData];$(".score span").html(parseInt($(".score span").html())+150);addSparkles(Math.random()*200+100|0,c.easelObj.x,c.easelObj.y,2)}}}};var fruits=function(){this.arrow=null;this.fruitsTotal=0;this.fruitsOnAir=false,this.fruitsRelease=false,this.init=function(a){var b=base.world.bodiesMap[a];this.addEvent(b)}};fruits.prototype.destroyFruit=function(a){setTimeout(function(){myBadMonkey.removeBody(a);backtopav=true},5e3)};fruits.prototype.addEvent=function(target){var that=this;target.easelObj.onPress=function(e){var distanceX,distanceY,euclidDist,degrees,frameNo,arrowAngle;target.initPositionXpixels=e.stageX;target.initPositionYpixels=e.stageY;e.onMouseMove=function(a){distanceX=a.stageX-target.initPositionXpixels;distanceY=a.stageY-target.initPositionYpixels;arrowAngle=Math.atan2(distanceY,distanceX);degrees=Math.round(arrowAngle*180/Math.PI);euclidDist=distanceX*distanceX+distanceY*distanceY;fruitProjectile.animation.rotation=degrees-90;if(euclidDist>150){frameNo="b"}if(euclidDist>300){frameNo="c"}if(euclidDist>600){frameNo="d"}if(euclidDist>1200){frameNo="e"}if(euclidDist>2400){frameNo="f"}fruitProjectile.animation.gotoAndPlay(frameNo)};e.onMouseUp=function(event){target.setType("dynamic");var distance=Math.sqrt(distanceX*distanceX+distanceY*distanceY);target.body.SetLinearVelocity(base.world.vector(-distance*Math.cos(arrowAngle)/1.5,-distance*Math.sin(arrowAngle)/1.5));target.easelObj.onPress=null;that.fruitsOnAir=true;if(mike.isInIdleMode){mike.animation.gotoAndPlay("throw")}fruitProjectile.animation.gotoAndStop("a");that.fruitsTotal--;updateFruitsGUI(that.fruitsTotal);rolling=true;rollingTarget=-500;rollingSpeed=7;if(!that.fruitsRelease){window.fruity=setTimeout(function(){that.fruitsRelease=true;if(that.fruitsTotal>0&&badassKill<totalBadass){var assets=eval("GameLevel.level_"+currentLevel);var fruitList=assets.fruitObject;var currentFruit=that.fruitsTotal-1;cFruit.push(fruitList[currentFruit].userData);gameWorld[fruitList[currentFruit].userData]=new monkeyType(fruitList[currentFruit]);base.world.addEntity(fruitList[currentFruit]);var ourFruit=new fruits;ourFruit.fruitsTotal=that.fruitsTotal;ourFruit.init(cFruit[cFruit.length-1]);fruitPreProj.animation.rotation=degrees-90;fruitPreProj.animation.gotoAndStop(frameNo);mike.animation.gotoAndPlay("normal")}else{rolling=false;gameover=true;clearTimeout(window.fruity)}},3e3)}}}};fruits.prototype.hitPoint=function(a,b){return this.hitRadius(a,b,0)};fruits.prototype.hitRadius=function(a,b,c){if(a-c>this.x+this.hit){return}if(a+c<this.x-this.hit){return}if(b-c>this.y+this.hit){return}if(b+c<this.y-this.hit){return}return this.hit+c>Math.sqrt(Math.pow(Math.abs(this.x-a),2)+Math.pow(Math.abs(this.y-b),2))};var myBadMonkey={addToWorld:function(a){for(var b in a){var c=a[b];base.world.addEntity(c)}},appendBody:function(a){var b=base.world.addEntity(a);objMap[a.userData]=b},follow:function(a){var b=300;var c=b-a.initPos;if(c>b&&c<800){base.world.easelStage.x=base.world.easelStage.x-(c-base.world.easelStage.x)*.01}},backfollow:function(){if(base.world.easelStage.x<0)base.world.easelStage.x=cams+10},removeBody:function(a){var b=a.body.GetUserData();str=" "+b;delete objMap[b];base.world.removeEntity(a)},colliderContactName:[],removeCollideBody:function(a){if(a!=undefined){addSparkles(Math.random()*200+100|0,a.easelObj.x,a.easelObj.y,2);this.colliderContactName.push(a)}}};var spriteLoader=function(a,b){this.animation=new BitmapAnimation(new SpriteSheet(a));b.addChild(this.animation)};var creatmush=function(a,b){this.animation;this.spriteData={};this.init=function(){this.spriteData=a;this.animation=new BitmapAnimation(new SpriteSheet(this.spriteData));b.addChild(this.animation)};this.init()};var guiSrc=new Image;var curPos=0;var curBack=-500;var bg;var groundWidth;var stageImgWidth;var sparkleMap=[];var imgfrm={0:imglists.explode_leaf,1:imglists.explode_red,2:imglists.explode_yellow};var spriteLists={startbtn:{images:[imglists.startbtn],frames:{width:145,height:52,regX:72.5,regY:26},animations:{normal:[0,0],hit:[1,1]}},replaybtn:{images:[imglists.replaybtn],frames:{width:105,height:70,regX:52.5,regY:35},animations:{normal:[0,0],hit:[1,1]}},nextbtn:{images:[imglists.nextbtn],frames:{width:105,height:70,regX:52.5,regY:35},animations:{normal:[0,0],hit:[1,1]}},homebtn:{images:[imglists.homebtn],frames:{width:105,height:70,regX:52.5,regY:35},animations:{normal:[0,0],hit:[1,1]}},pausebtn:{images:[imglists.pausebtn],frames:{width:105,height:70,regX:52.5,regY:35},animations:{normal:[0,0],hit:[1,1]}},statustext:{images:[imglists.statustxt],frames:{width:200,height:44,regX:100,regY:22},animations:{win:[0,0],fail:[1,1]}},eagle:{images:["img/eagle.png"],frames:{width:70,height:60,regX:35,regY:30},animations:{fly:[0,3,true,3],hit:[4,4]}},levelbtn:{images:[imglists.levelbtn],frames:{width:100,height:90,regX:50,regY:45},animations:{threestar:[0,0,false],twostar:[1,1,false],onestar:[2,2,false],nostar:[3,3,false],lock:[4,4,false]}},preprojTile:{images:[imglists.preprojectile],frames:{width:48,height:130,regX:24,regY:130},animations:{a:[0,0],b:[1,1],c:[2,2],d:[3,3],e:[4,4],f:[5,5]}}};var projTile={images:[imglists.projectile],frames:{width:48,height:130,regX:24,regY:130},animations:{a:[0,0],b:[1,1],c:[2,2],d:[3,3],e:[4,4],f:[5,5]}};badMonkey.prototype.addSparkle=function(a,b,c,d){spark=this.world.addEntity({radiusPixels:4,scaleX:25,scaleY:25,imgSrc:"img/sparkle_21x23.png",frames:{width:21,height:23,regX:10,regY:11},startFrame:Math.random()*13,xPixels:a,yPixels:b,xVelPixels:c,yVelPixels:d})};badMonkey.prototype.tick=function(){if(camFollow){myBadMonkey.follow(camTarget)}if(gameStart&&gamebg!=undefined){base.world.easelStage.x=dollyx;gamebg.x=-dollyx*.9}if(collisionStart){for(var a in damFruit){var b=base.world.bodiesMap[damFruit[a]];if(!b.body.IsAwake()){gameWorld[damFruit[a]].dead=true;cFruit.splice(cFruit.indexOf(damFruit[a]),1);damFruit.splice(a,1);if(badassKill>=totalBadass){rolling=false;gameover=true}reverseCam(0,7);if(damFruit.length==0){collisionStart=false}}}}var c=[];for(var d in gameWorld){var e=gameWorld[d];if(e&&gameWorld[d].dead){var f=base.world.bodiesMap[d];base.world.removeEntity(f);c.push(d)}}for(var g=0;g<c.length;g++){delete gameWorld[c[g]]}if(rolling){followPoint(rollingTarget,rollingSpeed);if(Math.floor(dollyx)>-2)rolling=false}if(eagle!=undefined){if(eagle.animation.x>800){eagle.animation.x=0}eagle.animation.x+=eagle.animation.vX;console.log(ourFruit.hitRadius(eagle.animation.x,eagle.animation.y,0))}var h=sparkleMap.length;if(h){for(var g=h-1;g>=0;g--){var i=sparkleMap[g];i.vY+=2;i.vX*=.98;i.x+=i.vX;i.y+=i.vY;i.scaleX=i.scaleY=i.scaleX+i.vS;i.alpha+=i.vA;if(i.alpha<=0||i.y>canvas.height){base.world.easelStage.removeChild(i);sparkleMap.splice(g,1)}}}if(balljumped_high!=null){objMap["mushroom_blue"].easelObj.gotoAndPlay("jump");var j=objMap[balljumped_high].body.GetFixtureList();j.SetRestitution(1.5);j.SetDensity(.1);j.SetFriction(15);balljumped_high=null}if(balljumped_low!=null){objMap["mushroom_red"].easelObj.gotoAndPlay("jump");var j=objMap[balljumped_low].body.GetFixtureList();j.SetRestitution(.1);j.SetDensity(.5);j.SetFriction(0);balljumped_low=null}if(deleted){if(myBadMonkey.colliderContactName.length){for(var g=0;g<myBadMonkey.colliderContactName.length;g++)myBadMonkey.removeBody(myBadMonkey.colliderContactName[g]);myBadMonkey.colliderContactName.splice(g,1)}deleted=false}};return badMonkey}()}).call(this);$(document).ready(function(){canvas=document.getElementById("easelCanvas");debugCanvas=document.getElementById("debugCanvas");new badMonkey(canvas,debugCanvas)})