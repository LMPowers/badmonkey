(function(){var a,b=Object.prototype.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c){if(b.call(c,d))a[d]=c[d]}e.prototype=c.prototype;a.prototype=new e;a.__super__=c.prototype;return a};window.EaselBoxObject=function(){function c(a,b,c){var d,e,f,g,h;this.easelObj=a;d=c&&c.density||1;e=c&&c.friction||.5;f=c&&c.restitution||.2;g=c&&c.userData||null;this.fixDef=new Box2D.Dynamics.b2FixtureDef;this.fixDef.density=d;this.fixDef.friction=e;this.fixDef.restitution=f;this.fixDef.shape=b;this.bodyDef=new Box2D.Dynamics.b2BodyDef;this.bodyDef.userData=c.userData;if(c&&c.linearDamping){h=c.linearDamping;this.bodyDef.linearDamping=h}this.body=null}var b;c.prototype.update=function(){this.easelObj.x=this.body.GetPosition().x*a;this.easelObj.y=this.body.GetPosition().y*a;return this.easelObj.rotation=this.body.GetAngle()*(180/Math.PI)};c.prototype.setType=function(a){return this.body.SetType(b(a))};c.prototype.setState=function(b){var c,d,e,f,g,h,i,j,k,l,m,n;if(b&&b.xPixels){h=b.xPixels;g=h/a}else if(b&&b.Xmeters){g=b.Xmeters;h=g*a}else{g=0;h=0}if(b&&b.yPixels){l=b.yPixels;k=l/a}else if(b&&b.Xmeters){k=b.Ymeters;l=YMeters*a}else{k=0;l=0}if(b&&b.xVelPixels){j=b.xVelPixels;i=j/a}else if(b&&b.xVelMeters){i=b.xVelMeters;j=i*a}else{i=0;j=0}if(b&&b.yVelPixels){n=b.yVelPixels;m=n/a}else if(b&&b.yVelMeters){m=b.yVelMeters;n=m*a}else{m=0;n=0}if(b&&b.angleDegrees){c=b.angleDegrees;d=Math.PI*c/180}else if(b&&b.angleRadians){d=b.angleRadians;c=180*d/Math.PI}else{d=0;c=0}if(b&&b.angularVelRadians){f=b.angularVelRadians;e=180*f/Math.PI}else if(b&&b.angularVelDegrees){e=b.angularVelDegrees;f=Math.PI*e/180}else{e=0;f=0}this.easelObj.x=h;this.easelObj.y=l;this.easelObj.rotation=c;this.body.GetPosition().x=g;this.body.GetPosition().y=k;this.body.SetAngle(d);this.body.SetAngularVelocity(f);return this.body.SetLinearVelocity(new Box2D.Common.Math.b2Vec2(i,m))};b=function(a){if("dynamic"===a){return Box2D.Dynamics.b2Body.b2_dynamicBody}else if("static"===a){return Box2D.Dynamics.b2Body.b2_staticBody}else if("kinematic"===a){return Box2D.Dynamics.b2Body.b2_kinematicBody}};return c}();window.EaselBoxCircle=function(b){function d(b,c){var e,f,g,h,i;if(b==null)b=20;if(c==null)c=null;i=b/a;f=new Box2D.Collision.Shapes.b2CircleShape(i);h=null;if(c&&c.imgSrc){if(c&&c.frames){if(c.animations){g={images:[c.imgSrc],frames:c.frames,animations:c.animations}}else{g={images:[c.imgSrc],frames:c.frames}}e=new BitmapAnimation(new SpriteSheet(g));h=e.clone();h.gotoAndPlay(c.startFrame|0)}else{h=new Bitmap(c.imgSrc)}h.scaleX=c.scaleX||1;h.scaleY=c.scaleY||1;h.regX=b;h.regY=b}else{h=new Shape;h.graphics.beginRadialGradientFill(["#F00","#00F"],[.1,.9],0,0,0,0,0,b).drawCircle(0,0,b).beginFill("#FFF").drawRect(0,-1,b,2)}d.__super__.constructor.call(this,h,f,c)}c(d,b);return d}(EaselBoxObject);window.EaselBoxRectangle=function(b){function d(b,c,e){var f,g,h,i;if(e==null)e=null;i=b/a;g=c/a;f=new Box2D.Collision.Shapes.b2PolygonShape.AsBox(i/2,g/2);h=null;if(e&&e.imgSrc){h=new Bitmap(e.imgSrc);h.regX=b/2;h.regY=c/2}else{h=new Shape;h.graphics.beginLinearGradientFill(["#F00","#00F"],[0,.5],-b/2,0,b,0).drawRect(-b/2,-c/2,b,c)}d.__super__.constructor.call(this,h,f,e)}c(d,b);return d}(EaselBoxObject);window.EaselBoxPolygon=function(a){function b(a,c){var d,e,f,g,h;if(a==null)a=[{x:0,y:0},{x:1,y:0},{x:0,y:2}];if(c==null)c=null;h=20;radiusPixels=20;for(var i=0;i<a.length;i++){var j=new Box2D.Common.Math.b2Vec2;j.Set(a[i].x,a[i].y);a[i]=j}e=new Box2D.Collision.Shapes.b2PolygonShape.AsArray(a,a.length);g=null;if(c&&c.imgSrc){if(c&&c.frames){if(c.animations){f={images:[c.imgSrc],frames:c.frames,animations:c.animations}}else{f={images:[c.imgSrc],frames:c.frames}}d=new BitmapAnimation(new SpriteSheet(f));g=d.clone();g.gotoAndPlay(c.startFrame|0)}else{g=new Bitmap(c.imgSrc)}g.scaleX=c.scaleX||1;g.scaleY=c.scaleY||1;g.regX=radiusPixels;g.regY=radiusPixels}else{g=new Shape;g.graphics.beginRadialGradientFill(["#F00","#00F"],[.1,.9],0,0,0,0,0,radiusPixels).drawCircle(0,0,radiusPixels).beginFill("#FFF")}b.__super__.constructor.call(this,g,e,c)}c(b,a);return b}(EaselBoxObject);a=30;window.EaselBoxWorld=function(){function c(b,c,d,e,f,g,h){var i;this.callingObj=b;this.pixelsPerMeter=h;a=this.pixelsPerMeter;Ticker.addListener(this);Ticker.setFPS(c);this.Ticks=Ticker;this.box2dWorld=new Box2D.Dynamics.b2World(new Box2D.Common.Math.b2Vec2(f,g),true);this.easelStage=new Stage(d);this.objects=[];this.bodiesMap={};i=new Box2D.Dynamics.b2DebugDraw;i.SetSprite(e.getContext("2d"));i.SetDrawScale(this.pixelsPerMeter);i.SetFillAlpha(.3);i.SetLineThickness(1);i.SetFlags(Box2D.Dynamics.b2DebugDraw.e_shapeBit|Box2D.Dynamics.b2DebugDraw.e_jointBit);this.box2dWorld.SetDebugDraw(i)}var b;b=10;c.prototype.addEntity=function(a){var b;b=null;if(a.radiusPixels){b=new EaselBoxCircle(a.radiusPixels,a)}else if(a.points){b=new EaselBoxPolygon(a.points,a)}else{b=new EaselBoxRectangle(a.widthPixels,a.heightPixels,a)}this.easelStage.addChild(b.easelObj);b.body=this.box2dWorld.CreateBody(b.bodyDef);this.bodiesMap[b.body.GetUserData()]=b;b.body.CreateFixture(b.fixDef);b.setType(a.type||"dynamic");b.setState(a);this.objects.push(b);return b};c.prototype.removeEntity=function(a){this.box2dWorld.DestroyBody(a.body);this.easelStage.removeChild(a.easelObj)};c.prototype.addImage=function(a,b){var c,d,e;c=new Bitmap(a);for(d in b){e=b[d];c[d]=e}return this.easelStage.addChild(c)};c.prototype.tick=function(){var a,c,d,e;if(Ticker.getMeasuredFPS()>b){this.box2dWorld.Step(1/Ticker.getMeasuredFPS(),10,10);this.box2dWorld.ClearForces();e=this.objects;for(c=0,d=e.length;c<d;c++){a=e[c];a.update()}}if(typeof this.callingObj.tick==="function")this.callingObj.tick();this.easelStage.update();return this.box2dWorld.DrawDebugData()};c.prototype.vector=function(a,b){return new Box2D.Common.Math.b2Vec2(a,b)};c.prototype.addRevoluteJoint=function(a,b,c){var d=this.bodiesMap[a];var e=this.bodiesMap[b];var f=Box2D.Dynamics.Joints.b2RevoluteJointDef;var g=new f;g.Initialize(d.body,e.body,d.body.GetWorldCenter());if(c&&c.motorSpeed){g.motorSpeed=c.motorSpeed;g.maxMotorTorque=c.maxMotorTorque;g.enableMotor=true}this.box2dWorld.CreateJoint(g)};c.prototype.addPulleyJoint=function(a,b,c,d,e){var f=this.bodiesMap[a];var g=this.bodiesMap[b];var h=new Box2D.Common.Math.b2Vec2(c.x,c.y);var i=new Box2D.Common.Math.b2Vec2(d.x,d.y);var j=Box2D.Dynamics.Joints.b2PulleyJointDef;var k=new j;k.Initialize(f.body,g.body,h,i,f.body.GetWorldCenter(),g.body.GetWorldCenter(),1);this.box2dWorld.CreateJoint(k)};c.prototype.addContactListener=function(a){var b=new Box2D.Dynamics.b2ContactListener;if(a.BeginContact)b.BeginContact=function(b){a.BeginContact(b.GetFixtureA().GetBody().GetUserData(),b.GetFixtureB().GetBody().GetUserData())};if(a.EndContact)b.EndContact=function(b){a.EndContact(b.GetFixtureA().GetBody().GetUserData(),b.GetFixtureB().GetBody().GetUserData())};if(a.PostSolve)b.PostSolve=function(b,c){a.PostSolve(b.GetFixtureA().GetBody().GetUserData(),b.GetFixtureB().GetBody().GetUserData(),c.normalImpulses[0])};this.box2dWorld.SetContactListener(b)};return c}()}).call(this)